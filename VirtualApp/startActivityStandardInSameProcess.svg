<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="707px" preserveAspectRatio="none" style="width:2080px;height:707px;" version="1.1" viewBox="0 0 2080 707" width="2080px" zoomAndPan="magnify"><defs><filter height="300%" id="fyqzbdjsg62ke" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFB6C1" height="702.877" style="stroke: #A80036; stroke-width: 1.0;" width="934" x="50.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="470.5" y="16.5684">Client Process</text><rect fill="#90EE90" height="702.877" style="stroke: #A80036; stroke-width: 1.0;" width="1034.5" x="986.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="1454.75" y="16.5684">Server Process</text><rect fill="#ADD8E6" height="702.877" style="stroke: #A80036; stroke-width: 1.0;" width="56" x="2023" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="2036.5" y="16.5684">AMS</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="103.5" x2="103.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="221.5" x2="221.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="338.5" x2="338.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="475.5" x2="475.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="635.5" x2="635.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="776.5" x2="776.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="912.5" x2="912.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1085.5" x2="1085.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1283.5" x2="1283.5" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1470" x2="1470" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1665" x2="1665" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1802" x2="1802" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1952" x2="1952" y1="58.7988" y2="668.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2051" x2="2051" y1="58.7988" y2="668.3887"/><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="54.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="61.5" y="43.8457">StartActivity</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="54.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="61.5" y="687.9238">StartActivity</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="113" x="163.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="170.5" y="43.8457">HCallbackStub</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="113" x="163.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="170.5" y="687.9238">HCallbackStub</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="290.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="297.5" y="43.8457">VClientImpl</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="290.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="297.5" y="687.9238">VClientImpl</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="397.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="404.5" y="43.8457">AppInstrumentation</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="397.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="404.5" y="687.9238">AppInstrumentation</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="563.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="570.5" y="43.8457">ApplicationThread</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="563.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="570.5" y="687.9238">ApplicationThread</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="718.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="725.5" y="43.8457">ActivityThread</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="718.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="725.5" y="687.9238">ActivityThread</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="844.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="851.5" y="43.8457">VActivityManager</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="844.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="851.5" y="687.9238">VActivityManager</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="990.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="997.5" y="43.8457">VPackageManagerService</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="990.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="997.5" y="687.9238">VPackageManagerService</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="1191.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="1198.5" y="43.8457">VActivityManagerService</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="1191.5" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="1198.5" y="687.9238">VActivityManagerService</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1419" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1426" y="43.8457">ActivityStack</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1419" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1426" y="687.9238">ActivityStack</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1615" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1622" y="43.8457">ProviderCall</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1615" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1622" y="687.9238">ProviderCall</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="1726" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="1733" y="43.8457">VirtualCoreInServer</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="1726" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="1733" y="687.9238">VirtualCoreInServer</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="1888" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1895" y="43.8457">ComponentUtils</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="1888" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1895" y="687.9238">ComponentUtils</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="2027" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="2034" y="43.8457">AMS</text><rect fill="#FEFECE" filter="url(#fyqzbdjsg62ke)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="2027" y="667.3887"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="2034" y="687.9238">AMS</text><polygon fill="#A80036" points="92,85.7988,102,89.7988,92,93.7988,96,89.7988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="98" y1="89.7988" y2="89.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="10" y="85.3672">call(hooked)</text><polygon fill="#A80036" points="900.5,115.1094,910.5,119.1094,900.5,123.1094,904.5,119.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="906.5" y1="119.1094" y2="119.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="111" y="114.6777">startActivity</text><polygon fill="#A80036" points="1271.5,144.4199,1281.5,148.4199,1271.5,152.4199,1275.5,148.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="912.5" x2="1277.5" y1="148.4199" y2="148.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="919.5" y="143.9883">startActivity</text><polygon fill="#A80036" points="1458.5,173.7305,1468.5,177.7305,1458.5,181.7305,1462.5,177.7305" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1283.5" x2="1464.5" y1="177.7305" y2="177.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="1290.5" y="173.2988">startActivityLocked</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1470.5" x2="1512.5" y1="207.3516" y2="207.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1512.5" x2="1512.5" y1="207.3516" y2="220.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1471.5" x2="1512.5" y1="220.3516" y2="220.3516"/><polygon fill="#A80036" points="1481.5,216.3516,1471.5,220.3516,1481.5,224.3516,1477.5,220.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="1477.5" y="202.6094">startActivityProcess</text><polygon fill="#A80036" points="1294.5,245.3516,1284.5,249.3516,1294.5,253.3516,1290.5,249.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1288.5" x2="1469.5" y1="249.3516" y2="249.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="1300.5" y="244.9199">startProcessIfNeedLocked</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1470.5" x2="1512.5" y1="278.9727" y2="278.9727"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1512.5" x2="1512.5" y1="278.9727" y2="291.9727"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1471.5" x2="1512.5" y1="291.9727" y2="291.9727"/><polygon fill="#A80036" points="1481.5,287.9727,1471.5,291.9727,1481.5,295.9727,1477.5,291.9727" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="1477.5" y="274.2305">Intent: startActivityProcess</text><polygon fill="#FBFB77" filter="url(#fyqzbdjsg62ke)" points="1351,264.1621,1351,289.1621,1461,289.1621,1461,274.1621,1451,264.1621,1351,264.1621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1451" x2="1451" y1="264.1621" y2="274.1621"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1461" x2="1451" y1="274.1621" y2="274.1621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="1357" y="281.7305">替换后的Intent</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1470.5" x2="1512.5" y1="321.2832" y2="321.2832"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1512.5" x2="1512.5" y1="321.2832" y2="334.2832"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1471.5" x2="1512.5" y1="334.2832" y2="334.2832"/><polygon fill="#A80036" points="1481.5,330.2832,1471.5,334.2832,1481.5,338.2832,1477.5,334.2832" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="1477.5" y="316.541">startActivityFromSourceTask</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1470.5" x2="1512.5" y1="363.5938" y2="363.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1512.5" x2="1512.5" y1="363.5938" y2="376.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1471.5" x2="1512.5" y1="376.5938" y2="376.5938"/><polygon fill="#A80036" points="1481.5,372.5938,1471.5,376.5938,1481.5,380.5938,1477.5,376.5938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="1477.5" y="358.8516">realStartActivityLocked</text><polygon fill="#A80036" points="92,401.5938,102,405.5938,92,409.5938,96,405.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="98" y1="405.5938" y2="405.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="10" y="401.1621">call(hooked)</text><polygon fill="#A80036" points="1940.5,430.9043,1950.5,434.9043,1940.5,438.9043,1944.5,434.9043" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="1946.5" y1="434.9043" y2="434.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="111" y="430.4727">isStubComponent</text><polygon fill="#A80036" points="115,460.2148,105,464.2148,115,468.2148,111,464.2148" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="1951.5" y1="464.2148" y2="464.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="121" y="459.7832">boolean</text><polygon fill="#A80036" points="624,489.5254,634,493.5254,624,497.5254,628,493.5254" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="630" y1="493.5254" y2="493.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="10" y="489.0938">scheduleLaunchActivity</text><polygon fill="#A80036" points="233,523.8359,223,527.8359,233,531.8359,229,527.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="227" x2="775.5" y1="527.8359" y2="527.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="239" y="523.4043">handleLaunchActivity</text><polygon fill="#FBFB77" filter="url(#fyqzbdjsg62ke)" points="781,506.8359,781,531.8359,1071,531.8359,1071,516.8359,1061,506.8359,781,506.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1061" x2="1061" y1="506.8359" y2="516.8359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1071" x2="1061" y1="516.8359" y2="516.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="787" y="524.4043">修改ActivityClientRecord，恢复原始的Intent</text><polygon fill="#A80036" points="900.5,558.1465,910.5,562.1465,900.5,566.1465,904.5,562.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="222" x2="906.5" y1="562.1465" y2="562.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="229" y="557.7148">onActivityCreate</text><polygon fill="#A80036" points="1271.5,587.457,1281.5,591.457,1271.5,595.457,1275.5,591.457" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="912.5" x2="1277.5" y1="591.457" y2="591.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="919.5" y="587.0254">onActivityCreated</text><polygon fill="#A80036" points="1458.5,616.7676,1468.5,620.7676,1458.5,624.7676,1462.5,620.7676" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1283.5" x2="1464.5" y1="620.7676" y2="620.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="1290.5" y="616.3359">onActivityCreated</text><polygon fill="#A80036" points="486.5,646.0781,476.5,650.0781,486.5,654.0781,482.5,650.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="480.5" x2="775.5" y1="650.0781" y2="650.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="492.5" y="645.6465">callActivityOnCreate</text><!--
@startuml
box "Client Process" #LightPink
participant StartActivity
participant HCallbackStub
participant VClientImpl
participant AppInstrumentation
participant ApplicationThread
participant ActivityThread
participant VActivityManager
end box

box "Server Process" #LightGreen
participant VPackageManagerService
participant VActivityManagerService
participant ActivityStack
participant ProviderCall
participant VirtualCoreInServer
participant ComponentUtils
end box

box "AMS" #LightBlue
participant AMS
end box

-> StartActivity: call(hooked)
StartActivity -> VActivityManager: startActivity
VActivityManager -> VActivityManagerService : startActivity
VActivityManagerService -> ActivityStack: startActivityLocked
ActivityStack -> ActivityStack: startActivityProcess
ActivityStack -> VActivityManagerService: startProcessIfNeedLocked
ActivityStack - -> ActivityStack: Intent: startActivityProcess
note left
替换后的Intent
end note
ActivityStack -> ActivityStack: startActivityFromSourceTask
ActivityStack -> ActivityStack: realStartActivityLocked

-> StartActivity: call(hooked)
StartActivity -> ComponentUtils: isStubComponent
ComponentUtils - -> StartActivity : boolean

-> ApplicationThread: scheduleLaunchActivity
ActivityThread -> HCallbackStub: handleLaunchActivity
note right
修改ActivityClientRecord，恢复原始的Intent
end note
HCallbackStub -> VActivityManager: onActivityCreate
VActivityManager -> VActivityManagerService: onActivityCreated
VActivityManagerService -> ActivityStack: onActivityCreated
ActivityThread -> AppInstrumentation: callActivityOnCreate
@enduml

PlantUML version 1.2017.12(Thu Apr 27 00:06:36 CST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_112-release-b06
Operating System: Mac OS X
OS Version: 10.12.5
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>